<p>Audience: <span class="total"></span> <span class="users"></span></p>
<input class="username" type="username" value="" placeholder="username"/>
<input class="room" type="room" value="room1" placeholder="room"/>
<button class="connect" type="button">Connect</button>

<script src="bower_components/event-source-polyfill/eventsource.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.1.min.js"></script>
<script src="jquery.audience.js"></script>
<script>

  $(document).ready(function(){

    $('.username').val('a'+parseInt((Math.random()*1000)));

    var connect = function(username, room){
      var url = 'http://127.0.0.1:9999/' + room + '?username=' + username;
      $.audience(url, username).progress(function(data){
        $('.total').text(data.audience);
        if( data.added )
          $('.users').text( '(' + data.added.join(',')+' joined )');
        if( data.removed )
          $('.users').text( '(' + data.removed.join(',')+' left )');
      });
    };
    var buttonConnect = document.querySelector('.connect');
    buttonConnect.addEventListener('click', function(){
      connect( document.querySelector('.username').value, document.querySelector('.room').value )
    });


  });

</script>